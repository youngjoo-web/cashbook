<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gdu.cashbook.mapper.CashMapper">
	<select id="selectDayAndPriceList" parameterType="java.util.Map" resultType="com.gdu.cashbook.vo.DayAndPrice">
		SELECT DAY(cash_date) as day,
		SUM(CASE WHEN cash_kind='수입' THEN cash_price
		WHEN cash_kind='지출' THEN -cash_price END) as price
		FROM cash
		WHERE member_id = #{memberId}
		AND book_id = #{bookId}
		AND YEAR(cash_date) = #{year}
		AND MONTH(cash_date) = #{month}
		GROUP BY
		DAY(cash_date)
	</select>
	<select id="selectBookAndPriceList" parameterType="java.util.Map" resultType="com.gdu.cashbook.vo.BookAndPrice">
	
	</select>
	<select id="selectCashListByDate" parameterType="com.gdu.cashbook.vo.Cash" resultType="com.gdu.cashbook.vo.Cash">
		SELECT
		member_id as memberId,
		cash_date as cashDate,
		cash_kind as cashKind,
		category_name as categoryName,
		cash_price as cashPrice,
		cash_place as cashPlace,
		cash_memo as cashMemo
		FROM cash
		WHERE member_id = #{memberId}
		AND book_id = #{bookId}
		AND cash_date = #{cashDate}
	</select>
	<select id="selectCashKindSum" parameterType="com.gdu.cashbook.vo.Cash" resultType="int">
		SELECT SUM(CASE
		WHEN cash_kind='수입' THEN cash_price WHEN cash_kind='지출' THEN
		-cash_price END) as price FROM cash
		WHERE member_id = #{memberId} 
		AND book_id = #{bookId}
		AND cash_date=#{cashDate}
	</select>
</mapper>